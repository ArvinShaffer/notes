[TOC]

BREP 格式用于存储 3D 模型，并允许存储由顶点、边、线、面、壳、实体、复合体、复合物、边三角剖分、面三角剖分、三角剖分上的折线、空间位置和方向组成的模型。 任何此类模型的集合都可以存储为单个模型，该模型是模型的复合体。

格式按照便于理解的顺序进行描述，而不是按照格式各部分的顺序进行描述。 本文档中使用了类似 BNF 的定义。 大多数章节包含按以下顺序的 BREP 格式描述：

- 格式化文件片段来说明该部分；
- 零件的类似 BNF 的定义；
- 部分的详细描述。

请注意，该格式是 Open CASCADE Technology (OCCT) 的一部分。

该格式的某些数据字段具有附加值，用于 OCCT。

该格式的某些数据字段特定于 OCCT。

# 格式通用结构

ASCII 编码用于从/向文件读/写 BREP 格式。格式数据作为文本数据存储在文件中。

BREP 格式使用以下 BNF 术语：

- <\n>：是操作系统相关的ASCII字符序列，用于分隔所使用的操作系统中的ASCII文本字符串；
- <\_\n>: = " "\*<\n>;
- <\_>: = " "+;它是一个非空的空格字符序列，ASCII 码为 21h；
- <标志>: = "0" | "1";
- <int>：是一个从-231到231-1的整数，以十进制书写；
- <real>：它是一个实数，从 -1.7976931348623158 ⋅ 10308 到 1.7976931348623158 ⋅ 10308 以十进制或 E 形式书写，以 10 为底。点用作整数和小数部分的分隔符；
- <二维点>: = <real><\_><real>;
- <3D点>: = $<real>(<\_><real)>^2$​;
- <二维方向>：是一个<二维点> x y\* 使得$^*x^2 + y^2 = 1$​；
  <3D方向>：是一个<3D点> x y z* 使得$^*x^2 + y^2 + z^2 = 1$；
- <+>：加法运算。

该格式由以下部分组成：

- <内容类型>;
- <版本>;
- <位置>;
- <几何>;
- <形状>。

<内容类型> = "DBRep_DrawableShape" <_\n><_\n>; <内容类型> 有其他值。

<version> = ("CASCADE Topology V1, (c) Matra-Datavision" | "CASCADE Topology V2, (c) Matra-Datavision")<_\n>;文档中描述了版本的差异。

<locations>、<geometry> 和 <shapes> 部分在以下文档的单独章节中进行了描述。

# Locations
**Example**

```
    Locations  3  
    1  
                   0               0               1               0   
                   1               0               0               0   
                   0               1               0               0   
    1  
                   1               0               0               4   
                   0               1               0               5   
                   0               0               1               6   
    2   1 1 2 1 0 
```

**BNF-like Definition**

```
    <locations> = <location header> <_\n> <location records>;  
    <location header> = "Locations" <_> <location record count>;  
    <location record count> = <int>;  
    <location records> = <location record> ^ <location record count>;  
    <location record> = <location record 1> | <location record 2>;  
    <location record 1> = "1" <_\n> <location  data 1>;  
    <location record 2> = "2" <_> <location  data 2>;  
    <location data 1> = ((<_> <real>) ^ 4 <_\n>) ^ 3;  
    <location data 2> = (<int> <_> <int> <_>)* "0" <_\n>;  
```

**Description**

<location data 1> 被解释为3 x 4的矩阵 $Q = \begin{pmatrix} q_{1,1} & q_{1,2} & q_{1,3} & q_{1,4} \\ q_{2,1} & q_{2,2} & q_{2,3} & q_{2,4} \\ q_{3,1} & q_{3,2} & q_{3,3} & q_{3,4} \end{pmatrix}$ ，它描述了 3 维空间的变换并满足以下约束：

- $d \neq 0 \  where \ d = |Q_2| \ where \ Q_2 = \begin{pmatrix} q_{1,1} & q_{1,2} & q_{1,3} & q_{1,4} \\ q_{2,1} & q_{2,2} & q_{2,3} & q_{2,4} \\ q_{3,1} & q_{3,2} & q_{3,3} & q_{3,4} \end{pmatrix}$
- $Q^T_3 = Q^{-1}_3 \ where \ Q_3 = Q_2/d^{1/3}$

变换通过以下规则将一个点 (x, y, z) 转换为另一个点 (u, v, w)：
$$
\begin{pmatrix} u \\ v \\ w \end{pmatrix} = Q \cdot (x\ y \ z \ 1)^T = \begin{pmatrix} q_{1,1} \cdot x + q_{1,2} \cdot y + q_{1,3} \cdot z + q_{1, 4} \\ q_{2,1} \cdot x + q_{2,2} \cdot y + q_{2,3} \cdot z + q_{2, 4} \\ q_{3,1} \cdot x + q_{3,2} \cdot y + q_{3,3} \cdot z + q_{3, 4}  \end{pmatrix}
$$


Q 可能是以下基本变换的矩阵组合：

- 平行翻译 - $\begin{pmatrix}1 & 0 & 0 & q_{1,4} \\ 0 & 1 & 0 & q_{2,4} \\ 0 & 0 & 1 & q_{3,4} \end{pmatrix}$

- 绕轴旋转一个方向 $D(D_x, D_y, D_z)$​​​​​一个角度 $\varphi - $​

$$
\begin{pmatrix}D_x^2 \cdot (1 - cos(\varphi)) + cos(\varphi) & D_x \cdot D_y \cdot(1 - cos(\varphi)) - D_z\cdot sin(\varphi) & D_x \cdot D_z \cdot (1 - cos(\varphi)) + D_y \cdot sin(\varphi) & 0 \\ D_x \cdot D_y \cdot (1 - cos(\varphi)) + D_z \cdot sin(\varphi) &  D_y^2 \cdot (1 - cos(\varphi)) + cos(\varphi) & D_y \cdot D_z \cdot (1 - cos(\varphi)) - D_x \cdot sin(\varphi) & 0 \\ D_x \cdot D_z \cdot (1 - cos(\varphi)) - D_y \cdot sin(\varphi) & D_y \cdot D_z \cdot (1 - cos(\varphi)) + D_x \cdot sin(\varphi) & D_z^2 \cdot (1 - cos(\varphi)) + cos(\varphi) & 0\end{pmatrix}
$$

- $scaling \ - \  \begin{pmatrix}s & 0 & 0 & 0 \\ 0 & s & 0 & 0 \\ 0 & 0 & s & 0 \end{pmatrix} \ where \  S \in (-\infty, \infty)/\{0\};$​
- $central \ symmetry - \begin{pmatrix}-1 & 0 & 0 & 0 \\ 0 & -1 & 0 & 0 \\ 0 & 0 & -1 & 0 \end{pmatrix};$
- $axis \ symmetry - \begin{pmatrix}-1 & 0 & 0 & 0 \\ 0 & -1 & 0 & 0 \\ 0 & 0 & 1 & 0 \end{pmatrix};$
- $plane \ symmetry - \begin{pmatrix}1 & 0 & 0 & 0 \\ 0 & 1 & 0 & 0 \\ 0 & 0 & -1 & 0 \end{pmatrix};$

<location data 2> 被解释为位置的组合，并放置在 \<locations\> 部分中的此 <location data 2>之上。 <location data 2> 是$n \geq 0$​个整数对 $l_ip_i(1 \leq i \leq n)$​ 的序列 $l_1p_1...l_np_n$​ 。 \<flag\> 0 是序列结束的指示符。 该序列被解释为组合 $L^{p_1}_{l_1}⋅...⋅L^{p_n}_{l_n}$​，其中 $L_{l_i}$ 是来自第 li-th \<location record\> 的部分位置。 <位置记录> 编号从 1 开始。

# Geometry

```
    <geometry> =  
    <2D curves>  
    <3D curves>  
    <3D polygons> 
    <polygons on triangulations>  
    <surfaces>  
    <triangulations>;  
```

## 3D curves

**Example**

```
    Curves 13  
    1 0 0 0 0 0 1   
    1 0 0 3 -0 1 0   
    1 0 2 0 0 0 1   
    1 0 0 0 -0 1 0   
    1 1 0 0 0 0 1   
    1 1 0 3 0 1 0   
    1 1 2 0 0 0 1   
    1 1 0 0 -0 1 0   
    1 0 0 0 1 0 -0   
    1 0 0 3 1 0 -0   
    1 0 2 0 1 0 -0   
    1 0 2 3 1 0 -0   
    1 1 0 0 1 0 0 
```

**BNF-like Definition**

```
    <3D curves> = <3D curve header> <_\n> <3D curve records>;  
     
    <3D curve header> = "Curves" <_> <3D curve count>;  
     
    <3D curve count> = <int>;  
     
    <3D curve records> = <3D curve record> ^ <3D curve count>;  
     
    <3D curve record> =  
    <3D curve record 1> |  
    <3D curve record 2> |  
    <3D curve record 3> |  
    <3D curve record 4> |  
    <3D curve record 5> |  
    <3D curve record 6> |  
    <3D curve record 7> |  
    <3D curve record 8> |  
    <3D curve record 9>;  
```

### Line - <3D curve record 1>

**Example**

```
    1 1 0 3 0 1 0   
```

**BNF-like Definition**

```
    <3D curve record 1> = "1" <_> <3D point> <_> <3D direction> <_\n>;  
```

**Description**

<3D curve record 1>描述一条线。 线数据由 3D 点 *P*和 3D 方向 *D* 组成。 该线通过点 *P*，方向为 *D*，由以下参数方程定义：
$$
C(u) = P + u \cdot D, u \in (-\infty, \infty)
$$
示例记录被解释为通过点 *P*=(1, 0, 3) 的线，具有方向 *D*=(0, 1, 0) 并由以下参数方程定义：$C(u)=(1,0,3)+u⋅(0,1,0)$。

### Circle - <3D curve record 2>

**Example**

```
    2 1 2 3 0 0 1 1 0 -0 -0 1 0 4  
```

**BNF-like Definition**

```
<3D curve record 2> = "2" <_> <3D circle center> <_> <3D circle N> <_> <3D circle Dx> <_> <3D circle Dy> <_> <3D circle radius> <_\n>;  
<3D circle center> = <3D point>;  
<3D circle N> = <3D direction>;  
<3D circle Dx> = <3D direction>;  
<3D circle Dy> = <3D direction>;  
<3D circle radius> = <real>;  
```

**Description**

<3D curve record 2>描述了一个圆。 圆数据由 3D 点 *P*、成对正交 3D 方向 $N、D_x$​​​ 和 $D_y$​​​​以及非负实数 $r$​​​组成。 该圆的中心为 *P*，位于法线 *N* 的平面内。 圆的半径为 *r*，由以下参数方程定义：
$$
C(u) = P + r \cdot (cos(u) \cdot D_x + sin(u) \cdot D_y), u \in [0, 2\cdot \pi )
$$


示例记录被解释为一个圆，其中心为 $P=(1, 2, 3)$，位于法线 $N=(0, 0 ,1)$ 的平面内。 圆的方向是 $D_x=(1, 0 ,0)$ 和 $D_y=(0, 1 ,0)$。 该圆的半径为 $r=4$，由以下参数方程定义：$C(u)=(1,2,3)+4\cdot(cos(u)\cdot(1,0,0)+sin(u)\cdot(0,1,0))$。

### Ellipse - <3D curve record 3>

**Example**

```
    3 1 2 3 0 0 1 1 0 -0 -0 1 0 5  4  
```

**BNF-like Definition**

```
<3D curve record 3> = "3" <_> <3D ellipse center> <_> <3D ellipse N> <_> <3D ellipse Dmaj> <_> <3D ellipse Dmin> <_> <3D ellipse Rmaj> <_> <3D ellipse Rmin> <_\n>;  
<3D ellipse center> = <3D point>;  
<3D ellipse N> = <3D direction>;  
<3D ellipse Dmaj> = <3D direction>;  
<3D ellipse Dmin> = <3D direction>;  
<3D ellipse Rmaj> = <real>;  
<3D ellipse Rmin> = <real>;  
```

**Description**

<3D curve record 3> 描述一个椭圆。 椭圆数据由 3D 点 *P*、成对正交 3D 方向 $N, D_{maj}$和 $D_{min}$ 以及非负实数 $r_{maj}$ 和 $r_{min}$ 组成，因此 $r_{min} ≤ r_{maj}$。 椭圆的中心为 *P*，位于法线 *N* 的平面上，具有长轴和短轴方向 $D_{maj}$ 和 $D_{min}$，长和短半径 $r_{maj}$ 和 $r_{min}$，并由以下参数方程定义：
$$
C(u) = P + r_{maj} \cdot cos(u) \cdot D_{maj} + r_{min} \cdot sin(u) \cdot D_{min}, \ u \in [0, 2\cdot \pi)
$$


示例记录被解释为一个椭圆，其中心为 $P=(1, 2, 3)$​，位于法向 $N=(0, 0, 1)$ 的平面内，具有长轴和短轴方向 $D_{maj} = (1, 0, 0)$ 和 $D_{min} = (0, 1, 0)$ ，主要和次要半径 $r_{maj} = 5$ 和 $r_{min} = 4$ 并由以下参数方程定义：$C(u)=(1,2,3) + 5 \cdot cos(u) \cdot (1,0,0) + 4 \cdot sin(u) \cdot (0,1,0)$ 。

### Parabola - <3D curve record 4>

**Example**

```
    4 1 2 3 0 0 1 1 0 -0 -0 1 0  16  
```

**BNF-like Definition**

```
<3D curve record 4> = "4" <_> <3D parabola origin> <_> <3D parabola N> <_> <3D parabola Dx> <_> <3D parabola Dy> <_> <3D parabola focal length> <_\n>;  
<3D parabola origin> = <3D point>;  
<3D parabola N> = <3D direction>;  
<3D parabola Dx> = <3D direction>;  
<3D parabola Dy> = <3D direction>;  
<3D parabola focal length> = <real>;  
```

**Description**

<3D curve record 4> 描述抛物线。 抛物线数据由 3D 点 $P$​、成对正交 3D 方向 $N、D_x$​ 和 $D_y$​ 以及非负实数 $f$​ 组成。 抛物线位于通过点 $P$​ 并具有法线 $N$​ 的平面内。 抛物线的焦距为 $f$​，由以下参数方程定义：
$$
C(u) = P + \frac{u^2}{4 \cdot f} \cdot D_x + u \cdot D_y,\  u \in (-\infty, \infty) \Leftarrow f \neq 0; \\
C(u) = P + u \cdot D_x, \ u \in (-\infty, \infty) \Leftarrow f = 0 \ (degenerated \ case).
$$


示例记录被解释为平面中的抛物线，该抛物线通过点 $P=(1, 2, 3)$​ 并具有法线 $N=(0, 0, 1)$​。 抛物线的方向是 $D_x=(1, 0, 0)$​ 和 $D_y=(0, 1, 0)$​。 抛物线的焦距 $f=16$​，由以下参数方程定义：$C(u)=(1,2,3)+ \frac{u^2}{64}\cdot(1,0,0) + u \cdot (0,1,0)$​.

### Hyperbola - <3D curve record 5>

**Example**

```
    5 1 2 3 0 0 1 1 0 -0 -0 1 0 5  4  
```

**BNF-like Definition**

```
<3D curve record 5> = "5" <_> <3D hyperbola origin> <_> <3D hyperbola N> <_> <3D hyperbola Dx> <_> <3D hyperbola Dy> <_> <3D hyperbola Kx> <_> <3D hyperbola Ky> <_\n>;  
<3D hyperbola origin> = <3D point>;  
<3D hyperbola N> = <3D direction>;  
<3D hyperbola Dx> = <3D direction>;  
<3D hyperbola Dy> = <3D direction>;  
<3D hyperbola Kx> = <real>;  
<3D hyperbola Ky> = <real>; 
```

**Descripton**

<3D curve record 5> 描述一个双曲线。 双曲线数据由 3D 点 $P$、成对正交 3D 方向 $N$、$D_x$ 和 $D_y$ 以及非负实数 $k_x$ 和 $k_y$ 组成。 双曲线位于通过点$P$并具有法线$N$的平面内。 双曲线由以下参数方程定义：

$$
C(u) = P + k_x \cdot cosh(u) \cdot D_x + k_y \cdot sinh(u) \cdot D_y, \ u \in (-\infty, \infty).
$$


示例记录被解释为通过点 $P=(1, 2, 3)$ 并具有法线 $N=(0, 0, 1)$ 的平面中的双曲线。 其他双曲线数据有 $D_x=(1, 0, 0), D_y=(0, 1, 0), k_x=5$ 和 $k_y=4$。 双曲线由以下参数方程定义：$C(u)=(1,2,3)+5 \cdot cosh(u) \cdot (1,0,0)+4 \cdot sinh(u) \cdot (0,1, 0)$。

### Bezier Curve - <3D curve record 6>

**Example**

```
    6 1 2 0 1 0  4 1 -2 0  5 2 3  0  6   
```

**BNF-like Definition**

```
    <3D curve record 6> = "6" <_> <3D Bezier rational flag> <_> <3D Bezier degree> 
    <3D Bezier weight poles> <_\n>;
        
    <3D Bezier rational flag> = <flag>;
        
    <3D Bezier degree> = <int>;

    3D Bezier weight poles> = (<_> <3D Bezier weight pole>) ^ (<3D Bezier degree> <+> "1");

    <3D Bezier weight pole> = <3D point> [<_> <real>];
```

**Description**

<3D curve record 6>描述贝塞尔曲线。 曲线数据由有理数 $r$、度数 $m \leq 25$ 和权重极点组成。权重杆是 $m+1$ 个 3D 点 $B_0 ... B_m$ 如果标志 $r$ 是 0。权重杆是 $m+1$ 对 $B_0h_0 ... B_mh_m$ 如果标志 $r$ 是 1。这里 $B_i$ 是一个 3D 点，$h_i$ 是一个正实数 $(0 \leq i \leq m)$。 如果标志 $r$ 为 0，则 $h_i=1 (0 \leq i \leq m)$。贝塞尔曲线由以下参数方程定义：
$$
C(u) = \frac{\sum_{i=0}^{m} B_i \cdot h_i \cdot C_m^i \cdot u^i \cdot (1 - u)^{m - i}}{\sum_{i=0}^{m}h_i \cdot C_m^i \cdot u^i \cdot (1 - u)^{m - i}}, \ u \in [0, 1]
$$


其中 $0^0≡1$。

示例记录被解释为贝塞尔曲线，有理性标志$r=1$，度数 $m=2$ 和权重极点 $B_0=(0, 1, 0), h_0=4, B_1=(1, -2, 0), h_1 =5 \ and \  B_2=(2, 3, 0), h_2=6$ 。 贝塞尔曲线由以下参数方程定义：

$$
C(u) = \frac{(0, 1, 0) \cdot 4 \cdot (1 - u)^2 + (1, -2, 0) \cdot 5 \cdot 2 \cdot u \cdot (1 - u) + (2, 3, 0) \cdot 6 \cdot u^2}{4 \cdot (1 - u)^2 + 5 \cdot 2 \cdot u \cdot (1 - u) + 6 \cdot u^2}.
$$

### B-spline Curve - <3D curve record 7>

**Example**

```
    7 1 0  1 3 5  0 1 0  4 1 -2  0  5 2 3 0  6  
     0 1 0.25 1 0.5 1 0.75 1 1 1 
```

**BNF-like Definition**

```
<3D curve record 7> = "7" <_> <3D B-spline rational flag> <_> "0" <_> <3D B-spline degree> <_> 
<3D B-spline pole count> <_> <3D B-spline multiplicity knot count> <3D B-spline weight poles> 
<_\n> <3D B-spline multiplicity knots> <_\n>;
<3D B-spline rational flag> = <flag>;
<3D B-spline degree> = <int>;
<3D B-spline pole count> = <int>;
<3D B-spline multiplicity knot count> = <int>;
<3D B-spline weight poles> = (<_> <3D B-spline weight pole>) ^ <3D B-spline pole count>;
<3D B-spline weight pole> = <3D point> [<_> <real>];
<3D B-spline multiplicity knots> = (<_> <3D B-spline multiplicity knot>) ^ <3D B-spline multiplicity knot count>;
<3D B-spline multiplicity knot> = <real> <_> <int>;  
```

**Description**

<3D curve record 7> 描述 B 样条曲线。 曲线数据由有理标志$r$​、度数$m \leq 25$​、极数$n \geq 2$​、多重结数$k$​、权重极和多重结组成。如果标志 $r$​ 为 0，则权重极是 n 个 3D 点 *$B1 ... Bn$​*。如果标志 $r$​ 为 1，则权重极是 $n$​ 对 $B_1h_1 ... B_nh_n$​。这里是 $B_i$​  是一个 3D 点，$h_i$​ 是一个正实数 ($1 \leq i \leq n$​)。 如果标志 $r$​ 为 0，则 $h_i=1(1 \leq i \leq n)$​。多重结是 $k$​ 对 $u_1q_1 ... u_kq_k$​。 这里$u_i$​是一个重数$q_i \geq 1(1 \leq i \leq k)$​的结，使得
$$
u_i < u_{i+1}\ (1 \leq i \leq k - 1), \\
q_1 \leq m+1, q_k \leq m + 1, \ q_i \leq m \ (2 \leq i \leq k - 1), \sum_{i=1}^{k} q_i = m + n + 1.
$$


B 样条曲线由以下参数方程定义：
$$
C(u) = \frac{\sum_{i=1}^n B_i \cdot h_i \cdot N_{i, m+1}(u)}{\sum_{i=1}^n h_i \cdot N_{i, m+1}(u)}, \ u \in [u_1, u_k]
$$

其中函数 $N_i,j$ 具有以下 $j$ 的递归定义：

$$
N_{i,1}(u) = \left\{\begin{matrix} 1 \Leftarrow \bar{u}_i \leq u \leq \bar{u}_{i+1} \\  0 \Leftarrow u < \bar{u}_i \vee \bar{u}_{i+1} \leq u \end{matrix}\right. , N_{i,j}(u) = \frac{(u - \bar{u}_i) \cdot N_{i,j-1}(u)}{\bar{u}_{i+j-1} - \bar{u}_i} + \frac{(\bar{u}_{i+j} - u) \cdot N_{i+1, j-1}(u)}{\bar{u}_{i+j} - \bar{u}_{i+1}}, (2 \leq j \leq m + 1) \\
 where \\
 \bar{u}_i = u_j, (1 \leq j \leq k, \ \sum_{l=1}^{j-1}q_l + 1 \leq i \leq \sum_{l=1}^j q_l)
$$


示例记录被解释为 B 样条曲线，其中有理标志 $r=1$​，度数 $m=1$​，极点数 $n=3$​，多重结点数 $k=5$​，权重极点 $B_1=(0,1,0)， h_1=4, B_2=(1,-2,0), h_2=5 \ and \ B_3=(2,3,0), h_3=6$​, 多重结 $u_1=0, q_1=1, u_2=0.25, q_2=1 , u_3=0.5, q_3=1, u_4=0.75, q_4=1 \  and \  u_5=1, q_5=1$​。 B 样条曲线由以下参数方程定义：

$$
C(u) = \frac{(0, 1, 0) \cdot 4 \cdot N_{1, 2}(u) + (1, -2, 0) \cdot 5 \cdot N_{2,2}(u) + (2, 3, 0) \cdot 6 \cdot N_{3,2}(u)}{4 \cdot N_{1, 2}(u) + 5 \cdot N_{2,2}(u) + 6 \cdot N_{3,2}(u)}
$$

### Trimmed Curve - <3D curve record 8>

**Example**

```
    8  -4 5  
    1 1 2 3 1 0 0  
```

**BNF-like Definition**

```
<3D curve record 8> = "8" <_> <3D trimmed curve u min> <_> <3D trimmed curve u max> <_\n> <3D curve record>;
<3D trimmed curve u min> = <real>;
<3D trimmed curve u max> = <real>;  
```

**Description**

<3D curve record 8> 描述修剪后的曲线。 修剪后的曲线数据由实数 $u_{min}$ 和 $u_{max}$ 和 <3D curve record> 组成，因此 $u_{min} < u_{max}$。 修剪后的曲线是记录中描述的基曲线$B$对段$[u_{min},u_{max}] \subseteq domain(B)$的限制。 修整曲线由以下参数方程定义：
$$
C(u) = B(u), \  u \in [u_{min}, u_{max}].
$$


示例记录被解释为基本曲线 $B(u)=(1,2,3)+u \cdot (1,0,0)$​ 的 $u_{min}=-4$​ 和 $u_{max}=5$​ 的修剪曲线。 修剪后的曲线由以下参数方程定义：$C(u)=(1,2,3) + u \cdot (1,0,0), \ u \in [−4,5]$​。

### Offset Curve - <3D curve record 9>

**Example**

```
    9 2  
    0 1 0   
    1 1 2 3 1 0 0 
```

**BNF-like Definition**

```
    <3D curve record 9> = "9" <_> <3D offset curve distance> <_\n>;
    <3D offset curve direction> <_\n>;
    <3D curve record>;

    <3D offset curve distance> = <real>;

    <3D offset curve direction> = <3D direction>;  
```

**Description**

<3D curve record 9> 描述偏移曲线。 偏移曲线数据由距离$d、3D$​​方向$D$​​和 <3D curve record> 组成。 偏移曲线是将记录中描述的基曲线 $B$​​ 偏移到距离 $d$​​ 沿向量 $[B'(u),D] \neq \vec{0}$​​的结果。 偏移曲线由以下参数方程定义：

$$
C(u) = B(u) + d \cdot \frac{[B'(u), D]}{|[B'(u), D]|}, \  u \in domain(B).
$$


示例记录被解释为一条偏移曲线，距离 $d=2$，方向 $D=(0, 1, 0)$，基曲线 $B(u)=(1,2,3)+u \cdot (1,0,0) )$ 并由以下参数方程定义：$C(u)=(1,2,3)+u \cdot (1,0,0)+2 \cdot (0,0,1)$。

## Surfaces

**Example**

```
    Surfaces 6  
    1 0 0 0 1 0 -0 0 0 1 0 -1 0   
    1 0 0 0 -0 1 0 0 0 1 1 0 -0   
    1 0 0 3 0 0 1 1 0 -0 -0 1 0   
    1 0 2 0 -0 1 0 0 0 1 1 0 -0   
    1 0 0 0 0 0 1 1 0 -0 -0 1 0   
    1 1 0 0 1 0 -0 0 0 1 0 -1 0  
```

**BNF-like Definition**

```
    <surfaces> = <surface header> <_\n> <surface records>;

    <surface header> = “Surfaces” <_> <surface count>;

    <surface records> = <surface record> ^ <surface count>;

    <surface record> =
    <surface record 1> |
    <surface record 2> |
    <surface record 3> |
    <surface record 4> |
    <surface record 5> |
    <surface record 6> |
    <surface record 7> |
    <surface record 8> |
    <surface record 9> |
    <surface record 10> |
    <surface record 11>;  
```

### Plane - < surface record 1 >

**Example**

```
    1 0 0 3 0 0 1 1 0 -0 -0 1 0   
```

**BNF-like Definition**

```
    <surface record 1> = "1" <_> <3D point> (<_> <3D direction>) ^ 3 <_\n>;
```

**Description**

<surface record 1> 描述一个平面。 平面数据由 3D 点 $P$ 和成对的正交 3D 方向 $N、D_u$ 和 $D_v$ 组成。 该平面通过点 $P$，具有法线 $N$ 并由以下参数方程定义：
$$
S(u, v) = P + u \cdot D_u + v \cdot D_v, \ (u, v) \in (-\infty, \infty) \times (-\infty, \infty)
$$


示例记录被解释为通过点 $P=(0, 0, 3)$ 的平面，具有法向 $N=(0, 0, 1)$ 并由以下参数方程定义：$S(u,v) =(0,0,3)+u \cdot (1,0,0)+v \cdot (0,1,0)$。

### Cylinder - < surface record 2 >

**Example**

```
    2 1 2 3 0 0 1 1 0 -0 -0 1 0 4  
```

**BNF-like Definition**

```
    <surface record 2> = "2" <_> <3D point> (<_> <3D direction>) ^ 3 <_> <real> <_\n>;
```

**Description**

<surface record 2> 描述一个圆柱体。 圆柱体数据由 3D 点 $P$、成对正交 3D 方向 $D_v、D_X$ 和 $D_Y$ 以及非负实数 $r$ 组成。 圆柱轴通过点$P$，方向为$D_v$。 圆柱体的半径为 $r$，由以下参数方程定义：

$$
S(u, v) = P + r \cdot (cos(u) \cdot D_x + sin(u) \cdot D_y)+ v \cdot D_v, \ (u, v) \in [0, 2 \cdot \pi) \times (-\infty, \infty).
$$
示例记录被解释为一个圆柱体，其轴通过点 $P=(1, 2, 3)$ 并具有方向 $D_v=(0, 0, 1)$。 圆柱体的方向为 $D_X=(1,0,0)$ 和 $D_Y=(0,1,0)$。 圆柱的半径 $r=4$，由以下参数方程定义： $S(u,v)=(1,2,3)+4 \cdot (cos(u) \cdot D_X+sin(u) \cdot D_Y)+ v \cdot D_v$。

### Cone - < surface record 3 >

**Example**

```
    3 1 2 3 0 0 1 1 0 -0 -0 1 0 4  
    0.75
```

**BNF-like Definition**

```
    <surface record 3> = "3" <_> <3D point> (<_> <3D direction>) ^ 3 (<_> <real>) ^ 2 <_\n>; 
```

**Description**

<surface record 3> 描述一个锥体。 锥体数据由 3D 点 $P$​、对的正交 3D 方向 $D_Z、D_X$​ 和 $D_Y$​、非负实数 $r$​ 和实数 $\varphi \in (−\pi/2,\pi/2)/{0}$​ 组成。 锥轴通过点 $P$​，方向为 $D_Z$​。 通过点 $P$​ 并平行于方向 $D_X$​ 和 $D_Y$​ 的平面是圆锥参考平面。 平面的圆锥截面是半径为 $r$​ 的圆。 从点$P$​到圆锥顶点的方向是$-sgn(\varphi ) \cdot D_Z$​。 锥体有一个半角$|\varphi |$​ 并且由以下参数方程定义：
$$
S(u,v) = P + (r + v \cdot sin(\varphi)) \cdot (cos(u) \cdot D_X + sin(u) \cdot D_Y) + v \cdot cos(\varphi) \cdot D_Z, \ (u, v) \in [0, 2 \cdot \pi) \times (-\infty, \infty).
$$
示例记录被解释为一个圆锥体，其轴穿过点 $P=(1, 2, 3)$ 并且方向 $D_Z=(0, 0, 1)$。 其他锥体数据为 $D_X=(1, 0, 0), D_Y=(0, 1, 0), r=4$ 和 $\varphi =0.75$。 锥体由以下参数方程定义\varphi 

$$
S(u, v) = (1, 2, 3) + (4 + v \cdot sin(0.75)) \cdot (cos(u) \cdot (1, 0, 0) + sin(u) \cdot (0, 1, 0)) + v \cdot cos(0.75) \cdot (0, 0, 1).
$$

### Sphere - < surface record 4 >

**Example**

```
    4 1 2 3 0 0 1 1 0 -0 -0 1 0 4  
```

**BNF-like Definition**

```
    <surface record 4> = "4" <_> <3D point> (<_> <3D direction>) ^ 3 <_> <real> <_\n>;  
```

**Description**

<surface record 4> 描述一个球体。 球体数据由 3D 点 $P$、成对正交 3D 方向 $D_Z、D_X$ 和 $D_Y$ 以及非负实数 $r$ 组成。 球体的中心为 $P$，半径为 $r$，由以下参数方程定义：

$$
S(u, v) = P + r \cdot cos(v) \cdot (cos(u) \cdot D_x + sin(u) \cdot D_y) + r \cdot sin(v) \cdot D_z, \  (u, v) \in [0, 2 \cdot \pi) \times [-\pi/2, \pi/2].
$$
示例记录被解释为一个球体，其中心为 $P=(1, 2, 3)$。 球体的方向是 $D_Z=(0, 0, 1), D_X=(1, 0, 0)$ 和 $D_Y=(0, 1, 0)$。 球体的半径为 $r=4$，由以下参数方程定义：

$$
S(u,v) = (1, 2, 3) + 4 \cdot cos(v) \cdot (cos(u) \cdot (1, 0, 0) + sin(u) \cdot (0, 1, 0)) + 4 \cdot sin(v) \cdot (0, 0 ,1).
$$

### Torus - < surface record 5 >

**Example**

```
    5 1 2 3 0 0 1 1 0 -0 -0 1 0 8  4  
```

**BNF-like Definition**

```
    <surface record 5> = "5" <_> <3D point> (<_> <3D direction>) ^ 3 (<_> <real>) ^ 2 <_\n>; 
```

**Description**

<surface record 5> 描述一个圆环。 环面数据由 3D 点 $P$、成对正交 3D 方向 $D_Z、D_X$ 和 $D_Y$ 以及非负实数 $r_1$ 和 $r_2$ 组成。 圆环轴通过点 $P$ 并具有方向 $D_Z$。 $r_1$ 是环面圆心到轴的距离。 圆环的半径为$r_2$。 环面由以下参数方程定义：
$$
S(u, v) = P + (r_1 + r_2 \cdot cos(v)) \cdot (cos(u) \cdot D_x + sin(u) \cdot D_y) + r_2 \cdot sin(v) \cdot D_Z, \  (u, v) \in [0, 2 \cdot \pi) \times [0, 2 \cdot \pi)
$$
示例记录被解释为一个环面，其轴穿过点 $P=(1, 2, 3)$ 并且方向 $D_Z=(0, 0, 1)$。 对于环面，$D_X=(1, 0, 0), D_Y=(0, 1, 0), r_1=8$ 和 $r_2=4$。 环面由以下参数方程定义：

$$
S(u, v) = (1, 2, 3) + (8 + 4 \cdot cos(v)) \cdot (cos(u) \cdot (1, 0, 0) + sin(u) \cdot (0, 1, 0)) + 4 \cdot sin(v) \cdot (0, 0, 1).
$$

### Linear Extrusion - < surface record 6 >

**Example**

```
    6 0 0.6 0.8   
    2 1 2 3 0 0 1 1 0 -0 -0 1 0 4  
```

**BNF-like Definition**

```
    <surface record 6> = "6" <_> <3D direction> <_\n> <3D curve record>;  
```

**Description**

<surface record 6> 描述线性挤压表面。 表面数据由 3D 方向 $D_v$ 和 *<3D curve record>* 组成。 线性挤压表面具有方向 $D_v$，记录中描述的基曲线 $C$ 由以下参数方程定义：

$$
S(u,v) = C(u) + v \cdot D_v, \  (u, v) \in domain(C) \times (-\infty, \infty).
$$
示例记录被解释为方向为 $D_v=(0, 0.6, 0.8)$ 的线性挤压曲面。 基曲线是曲面的圆。 曲面由以下参数方程定义：  

$$
S(u, v) = (1, 2, 3) + 4 \cdot (cos(u) \cdot (1,0,0) + sin(u) \cdot (0,1,0)) + v \cdot (0,0.6,0,8),\  (u,v) \in [0, 2 \cdot \pi) \times (-\infty, \infty).
$$

### Revolution Surface - < surface record 7 >

**Example**

```
    7 -4 0 3 0 1 0   
    2 1 2 3 0 0 1 1 0 -0 -0 1 0 4  
```

**BNF-like Definition**

```
    <surface record 7> = "7" <_> <3D point> <_> <3D direction> <_\n> <3D curve record>;  
```

**Description**

<surface record 7> 描述一个旋转表面。 表面数据由 3D 点 $P$、3D 方向 $D$ 和 <3D 曲线记录>组成。 曲面轴通过点 *P* 并具有方向 $D$。 记录描述的基曲线*C*与轴共面。 曲面由以下参数方程定义：
$$
S(u,v) = P + V_D(v) + cos(u) \cdot (V(v) - V_D(v)) + sin(u) \cdot [D, V(v)], \ (u,v)  \in [0, 2\cdot \pi)  \times domain(C) \\
where \ V(v) = C(v) - P, \ V_D(v) = (D, V(v)) \cdot D.
$$
示例记录被解释为一个旋转表面，其轴穿过点 $P=(-4, 0, 3)$ 并且方向 $D=(0, 1, 0)$。 基曲线是曲面的圆。 曲面由以下参数方程定义：

$$
S(u,v) = (-4, 0, 3) + V_D(v) + cos(u) \cdot (V(v) - V_D(v)) + sin(u) \cdot [(0,1,0), V(v)],\ (u, v) \in [0, 2 \cdot \pi) \times [0, 2 \cdot \pi)  \\
where \  V(v) = (5, 2, 0) + 4 \cdot (cos(v) \cdot (1,0,0) + sin(v) \cdot (0,1,0)),\ V_D(v) = ((0,1,0), V(v)) \cdot (0,1,0).
$$

### Bezier Surface - < surface record 8 >

**Example**

```
    8 1 1 2 1 0 0 1  7 1 0 -4  10    
    0 1 -2  8 1 1 5  11   
    0 2 3  9 1 2 6  12   
```

**BNF-like Definition**

```
<surface record 8> = "8" <_> <Bezier surface u rational flag> <_> <Bezier surface v rational flag> <_> <Bezier surface u degree> <_> <Bezier surface v degree> <_> 
<Bezier surface weight poles>;
<Bezier surface u rational flag> = <flag>;
<Bezier surface v rational flag> = <flag>;
<Bezier surface u degree> = <int>;
<Bezier surface v degree> = <int>;
<Bezier surface weight poles> =
(<Bezier surface weight pole group> <_\n>) ^ (<Bezier surface u degree> <+> "1");
<Bezier surface weight pole group> = <Bezier surface weight pole>
(<_> <Bezier surface weight pole>) ^ <Bezier surface v degree>;
<Bezier surface weight pole> = <3D point> [<_> <real>];  
```

**Description**

<surface record 8> 描述贝塞尔曲面。 表面数据由一个 $u$ 有理数标志 $r_u$，$v$ 有理数标志 $r_v$，$u$度$m_u \leq 25$， $v$度 $m_v \leq 25$ 和权重极组成。

权重杆是 $(m_u + 1) \cdot (m_v + 1)$ 3D 点 $B_{i,j}((i, j) \in \{0,...,m_u\} \times \{0,...,m_v\})$ 如果 $r_u + r_v $ = 0。权重杆是 $(m_u + 1) \cdot (m_v + 1)$ pairs $B_{i,j}h_{i,j}((i, j) \in \{0,...,m_u\} \times \{0,...,m_v\})$ 如果 $r_u + r_v \neq 0$ 。这里 $B_{i, j}$是一个3D 点 并且 $h_{i, j}$ 是一个正实数 $((i,j) \in \{0,...,m_u\} \times \{0,...,m_v\})$。$h_{i,j}=1 \ ((i,j) \in \{0,...,m_u\} \times \{0,...,m_v\})$如果 $r_u + r_v = 0$。

贝塞尔曲面由以下参数方程定义：

$$
 S(u,v) = \frac{\sum_{i=0}^{m_u}\sum_{j=0}^{m_v}B_{i,j} \cdot h_{i,j} \cdot C_{m_u}^i \cdot u^i \cdot (1-u)^{m_u - i} \cdot C_{m_v}^j \cdot v^j \cdot (1 - v)^{m_v - j}}{\sum_{i=0}^{m_u}\sum_{j=0}^{m_v} h_{i,j} \cdot C_{m_u}^i \cdot u^i \cdot (1-u)^{m_u - i} \cdot C_{m_v}^j \cdot v^j \cdot (1 - v)^{m_v - j}},\ (u, v) \in [0,1] \times [0,1] \\
 where \  0^0 = 1
$$
示例记录被解释为贝塞尔曲面，其中 $a_u$ 有理标志 $r_u=1$，$v$ 有理标志 $r_v=1$，$u$ 度 $m_u=2$，$v$ 度 $m_v=1$，权重极点 $B_{0,0}=(0, 0, 1)， h_{0,0}=7, B_{0,1}=(1, 0, -4), h_{0,1}=10, B_{1,0}=(0, 1, -2), h_{1,0}=8, B_{1,1}=(1 , 1, 5), h_{1,1}=11, B_{2,0}=(0, 2, 3), h_{2,0}=9$ 和 $B_{2,1}=(1, 2, 6), h_{2,1}=12$。 曲面由以下参数方程定义：

$$
S(u,v) = [(0,0,1) \cdot 7 \cdot (1-u)^2 \cdot (1-v)+(1,0,-4) \cdot 10 \cdot (1 - u)^2 \cdot v + (0,1,-2) \cdot 8 \cdot 2 \cdot u \cdot (1-u) \cdot (1-v) + \\ 
(1,1,5) \cdot 11 \cdot 2 \cdot u \cdot (1-u)\cdot v + (0,2,3) \cdot 9 \cdot u^2 \cdot (1-v) + (1,2,6) \cdot 12 \cdot u^2 \cdot v] \div [7 \cdot (1-u)^2 \cdot (1-v) + \\
10 \cdot (1-u)^2 \cdot v + 8 \cdot 2 \cdot u \cdot (1-u) \cdot (1-v) + 11 \cdot 2 \cdot u \cdot (1-u) \cdot v + 9 \cdot u^2 \cdot (1-v) + 12 \cdot u^2 \cdot v]
$$

### B-spline Surface - < surface record 9 >

**Example**

```
    9  1 1 0 0 1 1 3 2 5 4 0 0 1  7 1 0 -4  10   
    0  1 -2  8 1 1 5  11   
    0  2 3  9 1 2 6  12   
     
    0  1  
    0.25  1  
    0.5  1  
    0.75  1  
    1  1  
     
    0  1  
    0.3  1  
    0.7  1  
    1 1  
```

**BNF-like Definition**

```
    <surface record 9> = "9" <_> <B-spline surface u rational flag> <_> 
    <B-spline surface v rational flag> <_> "0" <_> "0" <_> <B-spline surface u degree> <_> 
    <B-spline surface v degree> <_> <B-spline surface u pole count> <_> 
    <B-spline surface v pole count> <_> <B-spline surface u multiplicity knot count> <_> 
    <B-spline surface v multiplicity knot count> <_> <B-spline surface weight poles> <_\n> 
    <B-spline surface u multiplicity knots> <_\n> <B-spline surface v multiplicity knots>;

    <B-spline surface u rational flag> = <flag>;

    <B-spline surface v rational flag> = <flag>;

    <B-spline surface u degree> = <int>;

    <B-spline surface v degree> = <int>;

    <B-spline surface u pole count> = <int>;

    <B-spline surface v pole count> = <int>;

    <B-spline surface u multiplicity knot count> = <int>;

    <B-spline surface v multiplicity knot count> = <int>;

    <B-spline surface weight poles> =
    (<B-spline surface weight pole group> <_\n>) ^ <B-spline surface u pole count>;

    <B-spline surface weight pole group> =
    (<B-spline surface weight pole> <_>) ^ <B-spline surface v pole count>;

    <B-spline surface weight pole> = <3D point> [<_> <real>];

    <B-spline surface u multiplicity knots> =
    (<B-spline surface u multiplicity knot> <_\n>) ^ <B-spline surface u multiplicity knot count>;

    <B-spline surface u multiplicity knot> = <real> <_> <int>;

    <B-spline surface v multiplicity knots> =
    (<B-spline surface v multiplicity knot> <_\n>) ^ <B-spline surface v multiplicity knot count>;

    <B-spline surface v multiplicity knot> = <real> <_> <int>;
```

**Description**

<surface record 9> 描述 B 样条曲面。 表面数据由$a_u$有理数标志$r_u$，$v$有理数标志$r_v$，$u$度 $m_u \leq 25$，$v$度$m_v \leq 25$，$u$极数$n_u \geq 2$，$v$极数$n_v \geq 2$，$u$多重结点数$k_u$，$v$多重结点组成 计算 $k_v$，重量极点，$u$ 多重结，$v$ 多重结。

权重杆是 $n_u \cdot n_v$ 3D 点 $B_{i,j}((i,j) \in \{1,...,n_u\} \times \{1,...,n_v\})$ 如果 $r_u + r_v$。权重杆是 $n_u \cdot n_v$ pairs $B_{i,j}h_{i,j}((i,j) \in \{1,...n_u\} \times \{1,...,n_v\})$ 如果 $r_u + r_v \neq 0$。这里 $B_{i,j}$ 是一个3D 点和 $h_{i,j}$ 是一个正实数 $((i,j) \in \{1,...,n_u\} \times \{1,...,n_v\})$ 。$h_{i,j} = 1 ((i,j) \in \{1,...,n_u\} \times \{1,...,n_v \})$ 如果 $r_u + r_v = 0$ 。

u 多重结是 $k_u$ 对 $u_1q_1...u_ku_qk_u$。 这里 $u_i$ 是一个重数 $q_i \geq 1(1 \leq i \leq k_u)$ 的结，使得

$$
u_i < u_{i+1} \ (1 \leq i \leq k_u - 1), \\
q_1 \leq m_u + 1,\ q_{k_u} \leq m_u + 1, \ q_i \leq m_u (2 \leq i \leq k_u - 1), \ \sum_{i=1}^{k_u} q_i = m_u + n_u + 1.
$$
v 多重结是 $k_v$ 对 $v_1t_1...v_kv_tk_v$。 这里 $v_j$ 是一个重数为 $t_i \geq 1(1 \leq i \leq k_v)$ 的结，所以

$$
v_j < v_{j+1} \ (1 \leq j \leq k_v - 1), \\
t_1 \leq m_v + 1,\ t_{k_v} \leq m_v + 1, \ t_j \leq m_v (2 \leq j \leq k_v - 1), \ \sum_{j=1}^{k_v} t_j = m_v + n_v + 1.
$$

B 样条曲面由以下参数方程定义：

$$
S(u,v) = \frac{\sum_{i=1}^{n_u} \sum_{j=1}^{n_v}B_{i,j} \cdot h_{i,j} \cdot N_{i, m_{u+1}}(u) \cdot M_{j, m_{v+1}}(v)}{\sum_{i=1}^{n_u} \sum_{j=1}^{n_v}h_{i,j} \cdot N_{i, m_{u+1}}(u) \cdot M_{j, m_{v+1}}(v)}, \ (u, v) \in [u_1, u_{k_u}] \times [v_1, v_{k_v}]
$$
其中函数 $N_{i,j}$ 和 $M_{i,j}$ 具有以下由 $j$定义的递归：

$$
N_{i,1}(u) = \{ \begin{matrix} 1 \Leftarrow \bar{u}_i \leq u \leq \bar{u}_{i+1} \\ 0 \Leftarrow u < \bar{u}_i \vee \bar{u}_{i+1} \leq u \end{matrix}, \\
N_{i,j}(u) = \frac{(u - \bar{u}_i) \cdot N_{i,j-1}(u)}{\bar{u}_{i+j-1} - \bar{u}_i} + \frac{(\bar{u}_{i+j} - u) \cdot N_{i+1, j-1}(v)}{\bar{u}_{i+j} - \bar{u}_{i+1}}, \  (2 \leq j \leq m_u + 1), \\
M_{i,1}(v) = \{ \begin{matrix} 1 \Leftarrow \bar{v}_i \leq v \leq \bar{v}_{i+1} \\ 0 \Leftarrow v < \bar{v}_i \vee \bar{v}_{i+1} \leq v \end{matrix}, \\
M_{i,j}(v) = \frac{(v - \bar{v}_i) \cdot M_{i,j-1}(v)}{\bar{v}_{i+j-1} - \bar{v}_i} + \frac{(\bar{v}_{i+j} - v) \cdot M_{i+1, j-1}(v)}{\bar{v}_{i+j} - \bar{v}_{i+1}}, \  (2 \leq j \leq m_v + 1), \\
 where \\
 \bar{u}_i = u_j(1 \leq j \leq k_u, \sum_{l=1}^{j-1} q_l \leq i \leq \sum_{l=1}^{j}q_l) \\
 \bar{v}_i = v_j(1 \leq j \leq k_v, \sum_{l=1}^{j-1} t_l \leq i \leq \sum_{l=1}^{j}t_l)
$$
示例记录被解释为 B 样条曲面，其中 $a_u$ 有理标志 $r_u=1$，$v$ 有理标志 $r_v=1$，$u$ 度 $m_u=1$，$v$ 度 $m_v=1$，$u$ 极数 $n_u=3$，$v$ 极数 $n_v= 2$、$u$多重结数$k_u=5$、$v$多重结数$k_v=4$、权重极$B_{1,1}=(0,0,1),h_{1,1}=7,B_{1,2}=(1,0,-4) , h_{1,2}=10, B_{2,1}=(0, 1, -2), h_{2,1}=8, B_{2,2}=(1, 1, 5), h_{2,2}=11, B_{3,1}=(0 , 2, 3), h_{3,1}=9 and B_{3,2}=(1, 2, 6), h_{3,2}=12$, $u$ 多重结 $u_1=0, q_1=1, u_2=0.25, q_2=1, u_3 =0.5, q_3=1, u_4=0.75, q_4=1$ 和 $u_5=1, q_5=1$, $v$ 多重结 $v_1=0, r_1=1, v_2=0.3, r_2=1, v_3=0.7, r_3=1$ 和 $v_4=1，r_4=1$。 B 样条曲面由以下参数方程定义：

$$
S(u,v) = [(0,0,1) \cdot N_{1,2}(u) \cdot M_{1,2}(v) + (1,0,-4) \cdot 10 \cdot N_{1,2}(u) \cdot M_{2,2}(v) + \\
(0,1,-2) \cdot 8 \cdot N_{2,2}(u) \cdot M_{1,2}(v) + (1,1,5) \cdot 11 \cdot N_{2,2}(u) \cdot M_{2,2}(v) + \\
(0,2,3) \cdot 9 \cdot N_{3,2}(u) \cdot M_{1,2}(v) + (1,2,6) \cdot 12 \cdot N_{3,2}(u) \cdot M_{2,2}(v)] \div \\
[7 \cdot N_{1,2}(u) \cdot M_{1,2}(v) + 10 \cdot N_{1,2}(u) \cdot M_{2,2}(v) + 8 \cdot N_{2,2}(u) \cdot M_{1,2}(v) + \\
11 \cdot N_{2,2}(u) \cdot M_{2,2}(v) + 9 \cdot N_{3,2}(u) \cdot M_{1,2}(v) + 12 \cdot N_{3,2}(u) \cdot M_{2,2}(v)]
$$

### Rectangular Trim Surface - < surface record 10 >

**Example**

```
    10 -1 2 -3 4  
    1 1 2 3 0 0 1 1 0 -0 -0 1 0   
```

**BNF-like Definition**

```
    <surface record 10> = "10" <_> <trim surface u min> <_> <trim surface u max> <_> 
    <trim surface v min> <_> <trim surface v max> <_\n> <surface record>;

    <trim surface u min> = <real>;

    <trim surface u max> = <real>;

    <trim surface v min> = <real>;

    <trim surface v max> = <real>;  
```

**Description**

<surface record 10> 描述了一个矩形修剪表面。 表面数据由实数 $u_{min}, u_{max},v_{min}$ 和 $v_{max}$ 以及 <surface record> 组成，因此 $u_{min} < u_{max}$ 和 $v_{min} < v_{max}$。 矩形修整面是记录中描述的基面*B*到集合$[u_{min},u_{max}] \times [v_{min},v_{max}] \subseteq domain(B)$的限制。 矩形修剪曲面由以下参数方程定义：
$$
S(u,v) = B(u, v), (u, v) \in [u_{min},u_{max}] \times [v_{min},v_{max}].
$$
示例记录被解释为基面 $B(u,v)=(1,2,3)+u \cdot (1, 0,0)+v \cdot (0,1,0)$。 矩形修剪曲面由以下参数方程定义： $B(u,v)=(1,2,3)+u \cdot (1,0,0)+v \cdot (0,1,0),(u, v) \in [−1,2] \times [−3,4]$。

### Offset Surface - < surface record 11 >

**Example**

```
    11 -2  
    1 1 2 3 0 0 1 1 0 -0 -0 1 0   
```

**BNF-like Definition**

```
    <surface record 11> = "11" <_> <surface record distance> <_\n> <surface record>;

    <surface record distance> = <real>;  
```

**Description**

<surface record 11> 描述了一个偏移曲面。 偏移表面数据由距离 $d$ 和 <surface record> 组成。 偏移曲面是将记录中描述的基面 $B$ 偏移到沿曲面 $B$ 的法线 $N$ 距离 $d$ 的结果。 偏移曲面由以下参数方程定义：
$$
S(u,v) = B(u,v) + d \cdot N(u,v), (u,v) \in domain(B). \\
N(u,v) = [S'_u(u,v), S'_v(u, v)]  \\
if \  [S'_u(u,v), S'_v(u, v)] \neq \vec{0}
$$
示例记录被解释为具有距离 $d=-2$ 的偏移表面和基面 $B(u,v)=(1,2,3)+u \cdot (1,0,0)+v \cdot (0,1,0)$ 。 偏移曲面由以下参数方程定义： $S(u,v)=(1,2,3)+u \cdot (1,0,0)+v \cdot (0,1,0)−2 \cdot (0 ,0,1)$。

## 2D curves

**Example**

```
    Curve2ds 24  
    1 0 0 1 0   
    1 0 0 1 0   
    1 3 0 0 -1   
    1 0 0 0 1   
    1 0 -2 1 0   
    1 0 0 1 0   
    1 0 0 0 -1   
    1 0 0 0 1   
    1 0 0 1 0   
    1 0 1 1 0   
    1 3 0 0 -1   
    1 1 0 0 1   
    1 0 -2 1 0   
    1 0 1 1 0   
    1 0 0 0 -1   
    1 1 0 0 1   
    1 0 0 0 1   
    1 0 0 1 0   
    1 3 0 0 1   
    1 0 0 1 0   
    1 0 0 0 1   
    1 0 2 1 0   
    1 3 0 0 1   
    1 0 2 1 0   
```

**BNF-like Definition**

```
    <2D curves> = <2D curve header> <_\n> <2D curve records>;

    <2D curve header> = "Curve2ds" <_> <2D curve count>;

    <2D curve count> = <int>;

    <2D curve records> = <2D curve record> ^ <2D curve count>;

    <2D curve record> =
    <2D curve record 1> |
    <2D curve record 2> |
    <2D curve record 3> |
    <2D curve record 4> |
    <2D curve record 5> |
    <2D curve record 6> |
    <2D curve record 7> |
    <2D curve record 8> |
    <2D curve record 9>;  
```

### Line - <2D curve record 1>

**Example**

```
    1 3 0 0 -1   
```

**BNF-like Definition**

```
    <2D curve record 1> = "1" <_> <2D point> <_> <2D direction> <_\n>;  
```

**Description**

<2D curve record 1> 描述一条线。 线数据由二维点 $P$ 和二维方向 $D$ 组成。 该直线通过点 $P$，方向为 $D$，由以下参数方程定义：
$$
C(u) = P + u \cdot D, \  u \in (-\infty, \infty).
$$
示例记录被解释为一条通过点 $P=(3,0)$，方向 $D=(0,-1)$ 的线，并由以下参数方程定义：$C(u)=(3,0 )+u \cdot (0,−1)$。

### Circle - <2D curve record 2>

**Example**

```
    2 1 2 1 0 -0 1 3  
```

**BNF-like Definition**

```
<2D curve record 2> = "2" <_> <2D circle center> <_> <2D circle Dx> <_> <2D circle Dy> <_> <2D circle radius> <_\n>;
<2D circle center> = <2D point>;
<2D circle Dx> = <2D direction>;
<2D circle Dy> = <2D direction>;
<2D circle radius> = <real>; 
```

**Description**

<2D curve record 2> 描述一个圆圈。 圆数据由二维点 $P$、正交二维方向 $D_x$ 和 $D_y$ 以及非负实数 $r$ 组成。 圆的中心为 $P$。圆平面平行于方向 $D_x$ 和 $D_y$。 该圆的半径为 $r$，由以下参数方程定义：
$$
C(u) = P + r \cdot (cos(u)  \cdot D_x + sin(u) \cdot D_y), \  u \in [0, 2 \cdot \pi).
$$
示例记录被解释为一个圆心 $P=(1,2)$。 圆平面平行于方向 $D_x=(1,0)$ 和 $D_y=(0,1)$。 该圆的半径为 $r=3$，由以下参数方程定义：$C(u)=(1,2)+3 \cdot (cos(u) \cdot (1,0)+sin(u) \cdot (0, 1))$。

### Ellipse - <2D curve record 3>

**Example**

```
    3 1 2 1 0 -0 1 4 3  
```

**BNF-like Definition**

```
    <2D curve record 3> = "3" <_> <2D ellipse center> <_> <2D ellipse Dmaj> <_> 
    <2D ellipse Dmin> <_> <2D ellipse Rmaj> <_> <2D ellipse Rmin> <_\n>;

    <2D ellipse center> = <2D point>;

    <2D ellipse Dmaj> = <2D direction>;

    <2D ellipse Dmin> = <2D direction>;

    <2D ellipse Rmaj> = <real>;

    <2D ellipse Rmin> = <real>; 
```

**Description**

<2D curve record 3> 描述一个椭圆。 椭圆数据是二维点 $P$、正交二维方向 $D_{maj}$ 和 $D_{min}$ 以及 $r_{maj} ≤ r_{min}$ 的非负实数 $r_{maj}$ 和 $r_{min}$。 椭圆具有中心 $P$、长轴和短轴方向 $D_{maj}$ 和 $D_{min}$、长和短半径 $r_{maj}$ 和 $r_{min}$，并由以下参数方程定义：
$$
C(u) = P + r_{maj} \cdot cos(u) \cdot D_{maj} + r_{min} \cdot sin(u) \cdot D_{min}, \ u \in [0, 2 \cdot \pi).
$$
示例记录被解释为具有中心 $P=(1,2)$、长轴和短轴方向 $D_{maj}=(1,0)$ 和 $D_{min}=(0,1)$、长短半径 $r_{maj}=4$ 和 $r_{min}=3$ 的椭圆并由以下参数方程定义：$C(u)=(1,2)+4 \cdot cos(u) \cdot (1,0)+3 \cdot sin(u) \cdot (0,1)$。

### Parabola - <2D curve record 4>

**Example**

```
    4 1 2 1 0 -0 1 16  
```

**BNF-like Definition**

```
    <2D curve record 4> = "4" <_> <2D parabola origin> <_> <2D parabola Dx> <_> 
    <2D parabola Dy> <_> <2D parabola focal length> <_\n>;

    <2D parabola origin> = <2D point>;

    <2D parabola Dx> = <2D direction>;

    <2D parabola Dy> = <2D direction>;

    <2D parabola focal length> = <real>;  
```

**Description**

<2D curve record 4> 描述抛物线。 抛物线数据由二维点 $P$、正交二维方向 $D_x$ 和 $D_y$ 以及非负实数 $f$ 组成。 抛物线坐标系具有其原点 $P$ 和轴方向 $D_x$ 和 $D_y$。 抛物线的焦距为 $f$，由以下参数方程定义：
$$
C(u) = P + \frac{u^2}{4 \cdot f} \cdot D_x + u \cdot D_y, \ u \in (-\infty, \infty) \Leftarrow f \neq 0; \\
C(u) = P + u \cdot D_x, \ u \in (-\infty, \infty) \Leftarrow f = 0 \ (degenerated \ case).
$$
示例记录被解释为平面中的抛物线，该抛物线通过点 $P=(1,2)$ 并平行于方向 $D_x=(1,0)$ 和 $D_y=(0,1)$。 抛物线的焦距 $f=16$，由以下参数方程定义：$C(u)=(1,2)+ \frac{u^2}{64} \cdot (1,0)+u \cdot (0,1)$。

### Hyperbola - <2D curve record 5>

**Example**

```
5 1 2 1 0 -0 1 3 4
```

**BNF-like Definition**

```
    <2D curve record 5> = "5" <_> <2D hyperbola origin> <_> <2D hyperbola Dx> <_> 
    <2D hyperbola Dy> <_> <2D hyperbola Kx> <_> <2D hyperbola Ky> <_\n>;

    <2D hyperbola origin> = <2D point>;

    <2D hyperbola Dx> = <2D direction>;

    <2D hyperbola Dy> = <2D direction>;

    <2D hyperbola Kx> = <real>;

    <2D hyperbola Ky> = <real>;  
```

**Description**

<2D curve record 5> 描述一个双曲线。 双曲线数据由二维点 $P$、正交二维方向 $D_x$ 和 $D_y$ 以及非负实数 $k_x$ 和 $k_y$ 组成。 双曲线坐标系具有原点 $P$ 和轴方向 $D_x$ 和 $D_y$。 双曲线由以下参数方程定义：

$$
C(u) = P + k_x \cdot cosh(u) D_x + k_y \cdot sinh(u) \cdot D_y, \  u \in (-\infty, \infty).
$$
示例记录被解释为具有原点 $P=(1,2)$ 和轴方向 $D_x=(1,0)$ 和 $D_y=(0,1)$ 的坐标系的双曲线。 双曲线的其他数据是 $k_x=5$ 和 $k_y=4$。 双曲线由以下参数方程定义：$C(u)=(1,2)+3 \cdot cosh(u) \cdot (1,0)+4 \cdot sinh(u) \cdot (0,1)$。

### Bezier Curve - <2D curve record 6>

**Example**

```
6 1 2 0 1  4 1 -2  5 2 3  6   
```

**BNF-like Definition**

```
    <2D curve record 6> = "6" <_> <2D Bezier rational flag> <_> <2D Bezier degree> 
    <2D Bezier weight poles> <_\n>;

    <2D Bezier rational flag> = <flag>;

    <2D Bezier degree> = <int>;

    <2D Bezier weight poles> = (<_> <2D Bezier weight pole>) ^ (<2D Bezier degree> <+> “1”);

    <2D Bezier weight pole> = <2D point> [<_> <real>];
```

**Description**

<2D curve record 6> 描述贝塞尔曲线。 曲线数据由有理标志$r$、度数$m≤25$和权重极点组成。

权重杆是 $m+1$ 2D 点 $B_0 ... B_m$ 如果标志 $r$ 是 0。权重杆是 $m+1$ 对 $B_0h_0 ... B_mh_m$ 如果标志 $r$ 是 1。这里 $B_i$ 是一个二维点，$h_i$ 是一个正实数$(0 \leq i \leq m)$。 如果标志 $r$ 为 0，则 $h_i=1 (0 \leq i \leq m)$。

贝塞尔曲线由以下参数方程定义：

$$
C(u) = \frac{\sum_{i=0}^{m}B_i \cdot h_i \cdot C^i_m \cdot u^i \cdot (1 - u)^{m - i}}{\sum_{i=0}^{m} h_i \cdot C^i_m \cdot u^i \cdot (1 - u)^{m - i}}, \ u \in [0,1] \\ 
where \ 0^0 = 1
$$
示例记录被解释为贝塞尔曲线，其中有理标志 $r=1$、度数 $m=2$ 和权重极点 $B_0=(0,1),h_0=4,B_1=(1,-2), h_1=5$ 和 $B_2=(2,3),h_2=6$。 贝塞尔曲线由以下参数方程定义：

$$
C(u) = \frac{(0,1) \cdot 4 \cdot (1 - u)^2 + (1, -2) \cdot5 \cdot 2 \cdot u \cdot (1-u) + (2,3) \cdot 6 \cdot u^2}{4 \cdot (1 - u)^2 + 5 \cdot 2 \cdot u \cdot (1-u) + 6 \cdot u^2} .
$$

### B-spline Curve - <2D curve record 7>

**Example**

```
7 1 0  1 3 5  0 1  4 1 -2  5  2 3  6  
 0 1 0.25 1 0.5 1 0.75 1 1 1  
```

**BNF-like Definition**

```
<2D curve record 7> = "7" <_> <2D B-spline rational flag> <_> "0" <_> <2D B-spline degree> <_> <2D B-spline pole count> <_> <2D B-spline multiplicity knot count> <2D B-spline weight poles> <_\n> <2D B-spline multiplicity knots> <_\n>;
<2D B-spline rational flag> = <flag>;
<2D B-spline degree> = <int>;
<2D B-spline pole count> = <int>;
<2D B-spline multiplicity knot count> = <int>;
<2D B-spline weight poles> = <2D B-spline weight pole> ^ <2D B-spline pole count>;
<2D B-spline weight pole> = <_> <2D point> [<_> <real>];
<2D B-spline multiplicity knots> =
<2D B-spline multiplicity knot> ^ <2D B-spline multiplicity knot count>;
<2D B-spline multiplicity knot> = <_> <real> <_> <int>;
```

**Description**

<2D curve record 7> 描述 B 样条曲线。 曲线数据由有理标志$r$、度数$m \leq 25$、极数$n \geq 2$、多重结数$k$、权重极和多重结组成。

如果标志 $r$ 为 0，则权重极是 $n$ 2D 点 $B_1 ... B_n$。如果标志 $r$ 为 1，则权重极是 $n$ 对 $B_1h_1 ... B_nh_n$。这里 $B_i$ 是一个二维点，$h_i$ 是一个正实数 $(1 \leq i \leq n)$。 如果标志 $r$ 为 0，则 $h_i=1 (1 \leq i \leq n)$。

多重结是 $k$ 对 $u_1q_1 ... u_kq_k$。 这里$u_i$是一个重数$q_i \geq 1(1 \leq i \leq k)$的结，使得

$$
u_i < u_{i+1} \ (1 \leq i \leq k - 1), \\
q_1 \leq m + 1, \ q_k \leq m + 1, \ q_i \leq m (2 \leq i \leq k - 1), \ \sum_{i=1}^k q_i = m + n + 1.
$$
B 样条曲线由以下参数方程定义：

$$
C(u) = \frac{\sum_{i=1}^n B_i \cdot h_i \cdot N_{i, m+1}(u)}{\sum_{i=1}^n h_i \cdot N_{i, m+1}(u)}, \ u \in [u_1, u_k]
$$
其中函数 $N_{i,j}$ 具有以下递归定义 $j$

$$
N_{i,1}(u) = \{\begin{matrix} 1 \Leftarrow \bar{u}_i \leq u \leq \bar{u}_{i+1} \\ 0 \Leftarrow u < \bar{u}_i \vee \bar{u}_{i+1} \leq u \end{matrix} , \ N_{i,j}(u) = \frac{(u - \bar{u}_i) \cdot N_{i, j-1}(u)}{\bar{u}_{i+j-1} - \bar{u}_i} + \frac{(\bar{u}_{i+j} - u) \cdot N_{i+1, j-1}(u)}{\bar{u}_{i+j} - \bar{u}_{i+1}}, \ (2 \leq j \leq m + 1) \\
 where \\
 \bar{u}_i = u_j \ (1 \leq j \leq k, \ \sum_{l=1}^{j-1} q_l + 1 \leq i \leq \sum_{l=1}^j q_l)
$$
示例记录被解释为 B 样条曲线，其中有理标志 $r=1$，度数 $m=1$，极点数 $n=3$，重数结点数 $k=5$，权重极点 $B_1=(0,1),h_1=4, B_2=(1,-2), h_2=5 \  and \  B_3=(2,3), h_3=6$ 和多重结 $u_1=0, q_1=1, u_2=0.25, q_2=1, u_3=0.5 , q_3=1, u_4=0.75, q_4=1$ 和 $u_5=1, q_5=1$。 B 样条曲线由以下参数方程定义：

$$
C(u) = \frac{(0,1) \cdot 4 \cdot N_{1,2}(u) + (1, -2) \cdot 5 \cdot N_{2,2}(u) + (2,3) \cdot 6 \cdot N_{3,2}(u)}{4 \cdot N_{1,2}(u) + 5 \cdot N_{2,2}(u) + 6 \cdot N_{3,2}(u)}.
$$

### Trimmed Curve - <2D curve record 8>

**Example**

```
    8 -4 5  
    1 1 2 1 0   
```

**BNF-like Definition**

```
    <2D curve record 8> = "8" <_> <2D trimmed curve u min> <_> <2D trimmed curve u max> <_\n> 
    <2D curve record>;

    <2D trimmed curve u min> = <real>;

    <2D trimmed curve u max> = <real>;
```

**Description**

<2D curve record 8>描述修剪后的曲线。 修剪后的曲线数据由实数 $u_{min}$ 和 $u_{max}$ 以及 *<2D curve record>* 组成，因此 $u_{min}$ < $u_{max}$。 修剪后的曲线是记录中描述的基曲线*B*对段$[u_{min},u_{max}] \subseteq domain(B)$的限制。 修整曲线由以下参数方程定义：
$$
C(u) = B(u), \ u \in [u_{min}, u_{max}].
$$
示例记录被解释为修剪曲线，其中 $u_{min}=-4, u_{max}=5$ 和基本曲线 $B(u)=(1,2)+u \cdot (1,0)$。 修剪后的曲线由以下参数方程定义：$C(u)=(1,2)+u \cdot (1,0),u∈[−4,5]$。

### Offset Curve - <2D curve record 9>

**Example**

```
    9 2  
    1 1 2 1 0   
```

**BNF-like Definition**

```
<2D curve record 9> = "9" <_> <2D offset curve distance> <_\n> <2D curve record>;

<2D offset curve distance> = <real>;
```

**Description**

<2D curve record 9> 描述偏移曲线。 偏移曲线数据由距离 $d$ 和<2D curve record>组成。 偏移曲线是将记录中描述的基曲线 *B* 偏移到距离 $d$ 沿向量 $(B'_Y(u),−B'_X(u)) \neq \vec{0}$ 的结果，其中 $B(u) =(B'_X(u),B'_Y(u))$。 偏移曲线由以下参数方程定义：
$$
C(u) = B(u) + d \cdot (B'_Y(u),−B'_X(u)), \ u \in domain(B).
$$
示例记录被解释为具有距离 $d=2$ 和基本曲线 $B(u)=(1,2)+u \cdot (1,0)$ 的偏移曲线，并由以下参数方程定义：$C(u)= (1,2)+u \cdot (1,0)+2 \cdot (0,−1)$。

## 3D polygons

**Example**

```
    Polygon3D 1  
    2 1  
    0.1  
    1 0 0 2 0 0   
    0 1   
```

**BNF-like Definition**

```
    <3D polygons> = <3D polygon header> <_\n> <3D polygon records>;

    <3D polygon header> = "Polygon3D" <_> <3D polygon record count>;

    <3D polygon records> = <3D polygon record> ^ <3D polygon record count>;

    <3D polygon record> =
    <3D polygon node count> <_> <3D polygon flag of parameter presence> <_\n>
    <3D polygon deflection> <_\n>
    <3D polygon nodes> <_\n>
    [<3D polygon parameters> <_\n>];

    <3D polygon node count> = <int>;

    <3D polygon flag of parameter presence> = <flag>;

    <3D polygon deflection> = <real>;

    <3D polygon nodes> = (<3D polygon node> <_>) ^ <3D polygon node count>;

    <3D polygon node> = <3D point>;

    <3D polygon u parameters> = (<3D polygon u parameter> <_>) ^ <3D polygon node count>;

    <3D polygon u parameter> = <real>;
```

**Description**

<3D polygons> record 描述了近似于 3D 曲线 $C$ 的 3D 折线 $L$。 折线数据由节点数$m \geq 2$、参数存在标志$p$，偏转$d \geq 0$，节点$N_i(1 \leq i \leq m)$和参数$u_i(1 \leq i \leq m)$组成。 仅当 $p=1$ 时才存在参数。 多段线 $L$ 通过节点。 挠度 $d$ 描述了折线 $L$ 从曲线 $C$ 的挠度：

$$
\underset{P \in C}{max} \ \underset{Q \in L}{min} |Q - P| \leq d.
$$
参数$u_i(1 \leq i \leq m)$为曲线$C$上节点$N_i$的参数：

$$
C(u_i) = N_i
$$
示例记录描述了来自 $m=2$ 节点的折线，参数存在标志 $p=1$，偏转 $d=0.1$，节点 $N_1=(1,0,0)$ 和 $N_2=(2,0,0)$ 以及参数 $u_1= 0$ 且 $u_2=1$。

## Triangulations

**Example**

```
    Triangulations 6  
    4 2 1 0  
    0 0 0 0 0 3 0 2 3 0 2 0 0 0 3  0 3 -2 0 -2 2 4 3 2 1 4   
    4 2 1 0  
    0 0 0 1 0 0 1 0 3 0 0 3 0 0 0  1 3 1 3 0 3 2 1 3 1 4   
    4 2 1 0  
    0 0 3 0 2 3 1 2 3 1 0 3 0 0 0  2 1 2 1 0 3 2 1 3 1 4   
    4 2 1 0  
    0 2 0 1 2 0 1 2 3 0 2 3 0 0 0  1 3 1 3 0 3 2 1 3 1 4   
    4 2 1 0  
    0 0 0 0 2 0 1 2 0 1 0 0 0 0 0  2 1 2 1 0 3 2 1 3 1 4   
    4 2 1 0  
    1 0 0 1 0 3 1 2 3 1 2 0 0 0 3  0 3 -2 0 -2 2 4 3 2 1 4   
```

**BNF-like Definition**

```
<triangulations> = <triangulation header> <_\n> <triangulation records>;
<triangulation header> = "Triangulations" <_> <triangulation count>;
<triangulation records> = <triangulation record> ^ <triangulation count>;
<triangulation record> = <triangulation node count> <_> <triangulation triangle count> <_> <triangulation parameter presence flag> <_> <triangulation deflection> <_\n> 
<triangulation nodes> [<_> <triangulation u v parameters>] <_> <triangulation triangles> <_\n>;
<triangulation node count> = <int>;
<triangulation triangle count> = <int>;
<triangulation parameter presence flag> = <flag>;
<triangulation deflection> = <real>;
<triangulation nodes> = (<triangulation node> <_>) ^ <triangulation node count>;
<triangulation node> = <3D point>;
<triangulation u v parameters> =    
(<triangulation u v parameter pair> <_>) ^ <triangulation node count>;
<triangulation u v parameter pair> = <real> <_> <real>;
<triangulation triangles> = (<triangulation triangle> <_>) ^ <triangulation triangle count>;
<triangulation triangle> = <int> <_> <int> <_> <int>. 
```

**Description**

<triangulation record> 描述了近似于表面 $S$ 的三角剖分 $T$。 三角测量数据由节点数$m \geq 3$、三角形数$k \geq 1$，参数存在标志$p$，偏转$d \geq 0$，节点$N_i(1 \leq i \leq m)$，参数对$u_iv_i(1 \leq i \leq m)$组成 ), 三角形 $n_{j,1}\ n_{j,2}\ n_{j,3}\ (1 \leq j \leq k,\ n_{j,l} \in \{1,...,m\}(1 \leq l \leq 3))$。 仅当 $p=1$ 时才存在参数。 偏转描述了从表面的三角测量偏转：
$$
\underset{P \in S}{max} \ \underset{Q \in T}{min} |Q - P| \leq d.
$$
参数对 $u_iv_i(1 \leq i \leq m)$ 描述了表面上节点 $N_i$ 的参数：
$$
S(u_i, v_i) = N_i.
$$
三角形 $n_{j,1}\ n_{j,2}\ n_{j,3}\ (1 \leq j \leq k)$ 被解释为节点 $N_{n_j,1} \ N_{n_j,2} \ $ 和 $N_{n_j,3} \ $ 的三角形，节点以 $N_{n_j,1} \ N_{n_j,2} \ $ 和 $N_{n_j,3} \ $ 的顺序循环遍历 . 从三角剖分 $T$ 的任何一侧开始，它的所有三角形都具有相同的节点圆形遍历方向：顺时针或逆时针。

三角测量记录

```
    4 2 1 0  
    0 0 0 0 0 3 0 2 3 0 2 0 0 0 3  0 3 -2 0 -2 2 4 3 2 1 4 
```

描述具有 $m=4$ 个节点，$k=2$ 个三角形，参数存在标志 $p=1$，偏转 $d=0$，节点 $N_1=(0,0,0),N_2=(0,0,3),N_3=( 0,2,3)$ 和 $N_4=(0,2,0)$, 参数 $(u_1, v_1)=(0,0), (u_2, v_2)=(3,0), (u_3, v_3)=(3 ,-2)$ 和 $(u_4, v_4)=(0,-2)$，以及三角形 $(n_{1,1}, n_{1,2}, n_{1,3})=(2,4,3)$ 和 $(n_{2,1}, n_{2,2} , n_{2,3})=(2,1,4)$。 从点 $(1,0,0) ((-1,0,0))$ 开始，三角形具有节点圆形遍历的顺时针（逆时针）方向。

## Polygons on triangulations

**Example**

```
    PolygonOnTriangulations 24  
    2 1 2   
    p 0.1 1 0 3   
    2 1 4   
    p 0.1 1 0 3   
    2 2 3   
    p 0.1 1 0 2   
    2 1 2   
    p 0.1 1 0 2   
    2 4 3   
    p 0.1 1 0 3   
    2 1 4   
    p 0.1 1 0 3   
    2 1 4   
    p 0.1 1 0 2   
    2 1 2   
    p 0.1 1 0 2   
    2 1 2   
    p 0.1 1 0 3   
    2 2 3   
    p 0.1 1 0 3   
    2 2 3   
    p 0.1 1 0 2   
    2 4 3   
    p 0.1 1 0 2   
    2 4 3   
    p 0.1 1 0 3   
    2 2 3   
    p 0.1 1 0 3   
    2 1 4   
    p 0.1 1 0 2   
    2 4 3   
    p 0.1 1 0 2   
    2 1 2   
    p 0.1 1 0 1   
    2 1 4   
    p 0.1 1 0 1   
    2 4 3   
    p 0.1 1 0 1   
    2 1 4   
    p 0.1 1 0 1   
    2 1 2   
    p 0.1 1 0 1   
    2 2 3   
    p 0.1 1 0 1   
    2 4 3   
    p 0.1 1 0 1   
    2 2 3   
    p 0.1 1 0 1   
```

**BNF-like Definition**

```
    <polygons on triangulations> = <polygons on triangulations header> <_\n>
    <polygons on triangulations records>;

    <polygons on triangulations header> =
    "PolygonOnTriangulations" <_> <polygons on triangulations record count>;

    <polygons on triangulations record count> = <int>;

    <polygons on triangulations records> =
    <polygons on triangulations record> ^ <polygons on triangulations record count>;

    <polygons on triangulations record> =
    <polygons on triangulations node count> <_> <polygons on triangulations node numbers> <_\n>
    "p" <_> <polygons on triangulations deflection> <_>
    <polygons on triangulations parameter presence flag>
    [<_> <polygons on triangulations u parameters>] <_\n>;

    <polygons on triangulations node count> = <int>;

    <polygons on triangulations node numbers> =
    <polygons on triangulations node number> ^ <polygons on triangulations node count>;

    <polygons on triangulations node number> = <int>;

    <polygons on triangulations deflection> = <real>;

    <polygons on triangulations parameter presence flag> = <flag>;

    <polygons on triangulations u parameters> =
    (<polygons on triangulations u parameter> <_>) ^ <polygons on triangulations node count>;

    <polygons on triangulations u parameter> = <real>;
```

**Description**

<polygons on triangulations> 描述三角剖分上的折线 $L$，它近似于曲线 $C$。 折线数据由节点数 $m \geq 2$、节点数 $n_i \geq 1$、偏转 $d \geq 0$、参数存在标志 $p$ 和参数 $u_i(1 \leq i \leq m)$ 组成。 仅当 $p=1$ 时才存在参数。 挠度 $d$ 描述了折线 $L$ 从曲线 $C$ 的挠度：
$$
\underset{P \in C}{max} \ \underset{Q \in L}{min} |Q - P| \leq d.
$$
参数 $u_i(1 \leq i \leq m)$ 是曲线 $C$ 上的第 $n_i$ 个节点 $C(u_i)$ 参数。

## Geometric Sense of a Curve

上述曲线$C$的几何意义由参数$u$增加的方向决定。

# Shapes

An example of section shapes and a whole *.brep file are given in Appendix.

**BNF-like Definition**

```
    <shapes> = <shape header> <_\n> <shape records> <_\n> <shape final record>;

    <shape header> = "TShapes" <_> <shape count>;

    <shape count> = <int>;

    <shape records> = <shape record> ^ <shape count>;

    <shape record> = <shape subrecord> <_\n> <shape flag word> <_\n> <shape subshapes> <_\n>;

    <shape flag word> = <flag> ^ 7;

    <shape subshapes> = (<shape subshape> <_>)* "*";

    <shape subshape> =
    <shape subshape orientation> <shape subshape number> <_> <shape location number>;

    <shape subshape orientation> = "+" | "-" | "i" | "e";

    <shape subshape number> = <int>;

    <shape location number> = <int>;

    <shape final record> = <shape subshape>;

    <shape subrecord> =
    ("Ve" <_\n> <vertex data> <_\n>) |
    ("Ed" <_\n> <edge data> <_\n>) |
    ("Wi" <_\n> <_\n>) |
    ("Fa" <_\n> <face data>) |
    ("Sh" <_\n> <_\n>) |
    ("So" <_\n> <_\n>) |
    ("CS" <_\n> <_\n>) |
    ("Co" <_\n> <_\n>);
```

**Description**

<shape flag word> $f_1 \ f_2 \ f_3 \ f_4 \ f_5 \ f_6 \ f_7 \  <flag>s f_i(1 \leq i \leq 7) $ 按以下方式解释为形状标志：

- $f_1$ — 免费；
- $f_2$ — 修改；
- $f_3$ — 忽略（版本 1）\ 选中（版本 2）；
- $f_4$ — 可定向；
- $f_5$ — 关闭；
- $f_6$ — 无限；
- $f_7$ — 凸面。

这些标志以一种特殊的方式使用 。

<shape subshapeorientation> 解释如下：

- $+$ — 前进；
- $-$ — 反转；
- $i$ — 内部；
- $e$ — 外部。

<shape subshape orientation> 以特殊方式使用 。

<shape subshape number>是位于<shape subshape number>之上的<shape record>的编号。 <shape record> 倒序编号，从 1 开始。

<shape subrecord> 类型按以下方式解释：

- “Ve”—顶点；
- “埃德”—边缘；
- “Wi”—电线；
- “发”—脸；
- “Sh”—壳；
- “所以”—固体；
- “CS”—复合材料；
- “Co”—化合物。

<shape final record> 确定整个模型的方向和位置。

## Common Terms

The terms below are used by <vertex data>, <edge data> and <face data>.

**BNF-like Definition**

```
    <location number> = <int>;

    <3D curve number> = <int>;

    <surface number> = <int>;

    <2D curve number> = <int>;

    <3D polygon number> = <int>;

    <triangulation number> = <int>;

    <polygon on triangulation number> = <int>;

    <curve parameter minimal and maximal values> = <real> <_> <real>;

    <curve values for parameter minimal and maximal values> =
    real> <_> <real> <_> <real> <_> <real>;
```

**Description**

<location number> 是来自section location 的<location record> 的数量。 <location record> 编号从 1 开始。<location number> 0 被解释为身份位置。

<3D 曲线编号> 是 <geometry> 部分的 <3D 曲线> 小节中的 <3D 曲线记录> 的编号。 <3D曲线记录>编号从1开始。

<surface number> 是 <geometry> 部分的 <surfaces> 小节中的 <surface record> 的编号。 <表面记录>编号从1开始。

<2D 曲线编号> 是 <geometry> 部分的 <2D 曲线> 小节中的 <2D 曲线记录> 的编号。 <二维曲线记录>编号从1开始。

<3D 多边形编号> 是 <geometry> 部分的 <3D 多边形> 小节中的 <3D 多边形记录> 的编号。 <3D 多边形记录> 编号从 1 开始。

<triangulation number> 是 <geometry> 部分的 <triangulations> 小节中的 <triangulation record> 的编号。 <三角测量记录>编号从1开始。

<polygon on triangulation> number 是 <geometry> 部分的 <polygons on triangulations> 小节中 <polygons on triangulations 记录> 的数量。 <三角测量记录上的多边形>编号从 1 开始。

<曲线参数最小值和最大值> $u_{min}$ 和 $u_{max}$ 是曲线参数 $u$ 边界：$u_{min} \leq u \leq u_{max}$。

<参数最小值和最大值的曲线值> $u_{min}$ 和 $u_{max}$ 是实数对 $x_{min} y_{min}$ 和 $x_{max} y_{max}$ 即 $(x_{min}, y_{min})= C (u_{min})$ 和$ (x_{max}, y_{max})= C (u_{max} )$ 其中 $C$ 是曲线的参数方程。

## Vertex data

**BNF-like Definition**

```
    <vertex data> = <vertex data tolerance> <_\n> <vertex data 3D representation> <_\n> 
    <vertex data representations>;

    <vertex data tolerance> = <real>;

    <vertex data 3D representation> = <3D point>;

    <vertex data representations> = (<vertex data representation> <_\n>)* "0 0";

    <vertex data representation> = <vertex data representation u parameter> <_>
    <vertex data representation data> <_> <location number>;

    <vertex data representation u parameter> = <real>;

    <vertex data representation data> =
    ("1" <_> <vertex data representation data 1>) |
    ("2" <_> <vertex data representation data 2>) |
    ("3" <_> <vertex data representation data 3>);

    <vertex data representation data 1> = <3D curve number>;

    <vertex data representation data 2> = <2D curve number> <_> <surface number>;

    <vertex data representation data 3> =
    <vertex data representation v parameter> <_> <surface number>;

    <vertex data representation v parameter> = <real>;
```

**Description**

<vertex data representation u parameter> $U$ 的用法说明如下。

<顶点数据表示数据 1> 和参数 $U$ 描述了顶点 $V$ 在 3D 曲线 $C$ 上的位置。 参数$U$是曲线$C$上顶点$V$的参数：$C(u)=V$。

<顶点数据表示数据2>和参数$U$描述顶点$V$在位于表面上的二维曲线$C$上的位置。 参数$U$是曲线$C$上顶点$V$的参数：$C(u)=V$。

<顶点数据表示数据3>和参数$u$通过<顶点数据表示v参数>$v$：$S(u,v)=V$来描述顶点$V$在表面$S$上的位置。

<顶点数据容差> $t$ 描述了从顶点 $V$ 到顶点 $V$ 表示的集合 $R$ 的最大距离：
$$
\underset{P \in R}{max} |P - V| \leq t.
$$

## Edge data

**BNF-like Definition**

```
<edge data> = <_> <edge data tolerance> <_> <edge data same parameter flag> <_> edge data same range flag> <_> <edge data degenerated flag> <_\n> <edge data representations>;
<edge data tolerance> = <real>;
<edge data same parameter flag> = <flag>;
<edge data same range flag> = <flag>;
<edge data degenerated flag> = <flag>;
<edge data representations> = (<edge data representation> <_\n>)* "0";
<edge data representation> =
"1" <_> <edge data representation data 1>
"2" <_> <edge data representation data 2>
"3" <_> <edge data representation data 3>
"4" <_> <edge data representation data 4>
"5" <_> <edge data representation data 5>
"6" <_> <edge data representation data 6>
"7" <_> <edge data representation data 7>;
<edge data representation data 1> = <3D curve number> <_> <location number> <_>
<curve parameter minimal and maximal values>;
<edge data representation data 2> = <2D curve number> <_> <surface number> <_> 
<location number> <_> <curve parameter minimal and maximal values>
[<_\n> <curve values for parameter minimal and maximal values>];
<edge data representation data 3> = (<2D curve number> <_>) ^ 2 <continuity order> <_> <surface number> <_> <location number> <_> <curve parameter minimal and maximal values> <\n> <curve values for parameter minimal and maximal values>];
<continuity order> = "C0" | "C1" | "C2" | "C3" | "CN" | "G1" | "G2".
<edge data representation data 4> =
<continuity order> (<_> <surface number> <_> <location number>) ^ 2;
<edge data representation data 5> = <3D polygon number> <_> <location number>;
<edge data representation data 6> =
<polygon on triangulation number> <_> <triangulation number> <_> <location number>;
<edge data representation data 7> = (<polygon on triangulation number> <_>) ^ 2 
<triangulation number> <_> <location number>;
```

**Description**

标志<边缘数据相同参数标志>、<边缘数据相同范围标志>和<边缘数据退化标志>以特殊方式使用。

<边缘数据表示数据1>描述了3D曲线。

<边缘数据表示数据2>描述了表面上的二维曲线。 <参数最小值和最大值的曲线值> 仅在版本 2 中使用。

<边缘数据表示数据3>描述了封闭曲面上的二维曲线。 <参数最小值和最大值的曲线值> 仅在版本 2 中使用。

<边缘数据表示数据 5> 描述了 3D 折线。

<edge data representation data 6> 描述三角剖分上的折线。

<边数据容差> $t$ 描述了从边 $E$ 到边 $E$ 表示的集合 $R$ 的最大距离：

$$
\underset{C \in R}{max} \ \underset{P \in E}{max} \ \underset{Q \in C}{min} |Q - P| \leq t
$$

## Face data

**BNF-like Definition**

```
<face data> = <face data natural restriction flag> <_> <face data tolerance> <_> <surface number> <_> <location number> <\n> ["2" <_> <triangulation number>];
<face data natural restriction flag> = <flag>;
<face data tolerance> = <real>;
```

**Description**

<face data> 描述面 $F$ 的表面 $S$ 和面 $F$ 的三角剖分 $T$。 表面 $S$ 可能为空： <surface number> = 0。

<face data tolerance> $t$ 描述了从面 $F$ 到表面 $S$ 的最大距离：

$$
\underset{P \in F}{max} \  \underset{Q \in S}{min} |Q - P| \leq t
$$

标志<face data natural restriction flag>的特殊用途

# Appendix

This chapter contains a *.brep file example.

```
    DBRep_DrawableShape  
     
    CASCADE Topology V1, (c)  Matra-Datavision  
    Locations 3  
    1  
                  0                0               1               0   
                  1                0               0               0   
                  0                1               0               0   
    1  
                  1                0               0               4   
                  0                1               0               5   
                  0                0               1               6   
    2  1 1 2 1 0  
    Curve2ds 24  
    1 0 0 1 0   
    1 0 0 1 0   
    1 3 0 0 -1   
    1 0 0 0 1   
    1 0 -2 1 0   
    1 0 0 1 0   
    1 0 0 0 -1   
    1 0 0 0 1   
    1 0 0 1 0   
    1 0 1 1 0   
    1 3 0 0 -1   
    1 1 0 0 1   
    1 0 -2 1 0   
    1 0 1 1 0   
    1 0 0 0 -1   
    1 1 0 0 1   
    1 0 0 0 1   
    1 0 0 1 0   
    1 3 0 0 1   
    1 0 0 1 0   
    1 0 0 0 1   
    1 0 2 1 0   
    1 3 0 0 1   
    1 0 2 1 0   
    Curves 13  
    1 0 0 0 0 0 1   
    1 0 0 3 -0 1 0   
    1 0 2 0 0 0 1   
    1 0 0 0 -0 1 0   
    1 1 0 0 0 0 1   
    1 1 0 3 0 1 0   
    1 1 2 0 0 0 1   
    1 1 0 0 -0 1 0   
    1 0 0 0 1 0 -0   
    1 0 0 3 1 0 -0   
    1 0 2 0 1 0 -0   
    1 0 2 3 1 0 -0   
    1 1 0 0 1 0 0   
    Polygon3D 1  
    2 1  
    0.1  
    1 0 0 2 0 0   
    0 1   
    PolygonOnTriangulations 24  
    2 1 2   
    p 0.1 1 0 3   
    2 1 4   
    p 0.1 1 0 3   
    2 2 3   
    p 0.1 1 0 2   
    2 1 2   
    p 0.1 1 0 2   
    2 4 3   
    p 0.1 1 0 3   
    2 1 4   
    p 0.1 1 0 3   
    2 1 4   
    p 0.1 1 0 2   
    2 1 2   
    p 0.1 1 0 2   
    2 1 2   
    p 0.1 1 0 3   
    2 2 3   
    p 0.1 1 0 3   
    2 2 3   
    p 0.1 1 0 2   
    2 4 3   
    p 0.1 1 0 2   
    2 4 3   
    p 0.1 1 0 3   
    2 2 3   
    p 0.1 1 0 3   
    2 1 4   
    p 0.1 1 0 2   
    2 4 3   
    p 0.1 1 0 2   
    2 1 2   
    p 0.1 1 0 1   
    2 1 4   
    p 0.1 1 0 1   
    2 4 3   
    p 0.1 1 0 1   
    2 1 4   
    p 0.1 1 0 1   
    2 1 2   
    p 0.1 1 0 1   
    2 2 3   
    p 0.1 1 0 1   
    2 4 3   
    p 0.1 1 0 1   
    2 2 3   
    p 0.1 1 0 1   
    Surfaces 6  
    1 0 0 0 1 0 -0 0 0 1 0 -1 0   
    1 0 0 0 -0 1 0 0 0 1 1 0 -0   
    1 0 0 3 0 0 1 1 0 -0 -0 1 0   
    1 0 2 0 -0 1 0 0 0 1 1 0 -0   
    1 0 0 0 0 0 1 1 0 -0 -0 1 0   
    1 1 0 0 1 0 -0 0 0 1 0 -1 0   
    Triangulations 6  
    4 2 1 0  
    0 0 0 0 0 3 0 2 3 0 2 0 0 0 3  0 3 -2 0 -2 2 4 3 2 1 4   
    4 2 1 0  
    0 0 0 1 0 0 1 0 3 0 0 3 0 0 0  1 3 1 3 0 3 2 1 3 1 4   
    4 2 1 0  
    0 0 3 0 2 3 1 2 3 1 0 3 0 0 0  2 1 2 1 0 3 2 1 3 1 4   
    4 2 1 0  
    0 2 0 1 2 0 1 2 3 0 2 3 0 0 0  1 3 1 3 0 3 2 1 3 1 4   
    4 2 1 0  
    0 0 0 0 2 0 1 2 0 1 0 0 0 0 0  2 1 2 1 0 3 2 1 3 1 4   
    4 2 1 0  
    1 0 0 1 0 3 1 2 3 1 2 0 0 0 3  0 3 -2 0 -2 2 4 3 2 1 4   
     
    TShapes 39  
    Ve  
    1e-007  
    0 0 3  
    0 0  
     
    0101101  
    *  
    Ve  
    1e-007  
    0 0 0  
    0 0  
     
    0101101  
    *  
    Ed  
     1e-007 1 1 0  
    1  1 0 0 3  
    2  1 1 0 0 3  
    2  2 2 0 0 3  
    6  1 1 0  
    6  2 2 0  
    0  
     
    0101000  
    -39 0 +38 0 *  
    Ve  
    1e-007  
    0 2 3  
    0 0  
     
    0101101  
    *  
    Ed  
     1e-007 1 1 0  
    1  2 0 0 2  
    2  3 1 0 0 2  
    2  4 3 0 0 2  
    6  3 1 0  
    6  4 3 0  
    0  
     
    0101000  
    -36 0 +39 0 *  
    Ve  
    1e-007  
    0 2 0  
    0 0  
     
    0101101  
    *  
    Ed  
     1e-007 1 1 0  
    1  3 0 0 3  
    2  5 1 0 0 3  
    2  6 4 0 0 3  
    6  5 1 0  
    6  6 4 0  
    0  
     
    0101000  
    -36 0 +34 0 *  
    Ed  
     1e-007 1 1 0  
    1  4 0 0 2  
    2  7 1 0 0 2  
    2  8 5 0 0 2  
    6  7 1 0  
    6  8 5 0  
    0  
     
    0101000  
    -34 0 +38 0 *  
    Wi  
     
    0101000  
    -37 0 -35 0 +33 0 +32 0 *  
    Fa  
    0  1e-007 1 0  
    2  1  
    0101000  
    +31 0 *  
    Ve  
    1e-007  
    1 0 3  
    0 0  
     
    0101101  
    *  
    Ve  
    1e-007  
    1 0 0  
    0 0  
     
    0101101  
    *  
    Ed  
     1e-007 1 1 0  
    1  5 0 0 3  
    2  9 6 0 0 3  
    2  10 2 0 0 3  
    6  9 6 0  
    6  10 2 0  
    0  
     
    0101000  
    -29 0 +28 0 *  
    Ve  
    1e-007  
    1 2 3  
    0 0  
     
    0101101  
    *  
    Ed  
     1e-007 1 1 0  
    1  6 0 0 2  
    2  11 6 0 0 2  
    2  12 3 0 0 2  
    6  11 6 0  
    6  12 3 0  
    0  
     
    0101000  
    -26 0 +29 0 *  
    Ve  
    1e-007  
    1 2 0  
    0 0  
     
    0101101  
    *  
    Ed  
     1e-007 1 1 0  
    1  7 0 0 3  
    2  13 6 0 0 3  
    2  14 4 0 0 3  
    6  13 6 0  
    6  14 4 0  
    0  
     
    0101000  
    -26 0 +24 0 *  
    Ed  
     1e-007 1 1 0  
    1  8 0 0 2  
    2  15 6 0 0 2  
    2  16 5 0 0 2  
    6  15 6 0  
    6  16 5 0  
    0  
     
    0101000  
    -24 0 +28 0 *  
    Wi  
     
    0101000  
    -27 0 -25 0 +23 0 +22 0 *  
    Fa  
    0  1e-007 6 0  
    2  6  
    0101000  
    +21 0 *  
    Ed  
     1e-007 1 1 0  
    1  9 0 0 1  
    2  17 2 0 0 1  
    2  18 5 0 0 1  
    6  17 2 0  
    6  18 5 0  
    0  
     
    0101000  
    -28 0 +38 0 *  
    Ed  
     1e-007 1 1 0  
    1  10 0 0 1  
    2  19 2 0 0 1  
    2  20 3 0 0 1  
    6  19 2 0  
    6  20 3 0  
    0  
     
    0101000  
    -29 0 +39 0 *  
    Wi  
     
    0101000  
    -19 0 -27 0 +18 0 +37 0 *  
    Fa  
    0  1e-007 2 0  
    2  2  
    0101000  
    +17 0 *  
    Ed  
     1e-007 1 1 0  
    1  11 0 0 1  
    2  21 4 0 0 1  
    2  22 5 0 0 1  
    6  21 4 0  
    6  22 5 0  
    0  
     
    0101000  
    -24 0 +34 0 *  
    Ed  
     1e-007 1 1 0  
    1  12 0 0 1  
    2  23 4 0 0 1  
    2  24 3 0 0 1  
    6  23 4 0  
    6  24 3 0  
    0  
     
    0101000  
    -26 0 +36 0 *  
    Wi  
     
    0101000  
    -15 0 -23 0 +14 0 +33 0 *  
    Fa  
    0  1e-007 4 0  
    2  4  
    0101000  
    +13 0 *  
    Wi  
     
    0101000  
    -32 0 -15 0 +22 0 +19 0 *  
    Fa  
    0  1e-007 5 0  
    2  5  
    0101000  
    +11 0 *  
    Wi  
     
    0101000  
    -35 0 -14 0 +25 0 +18 0 *  
    Fa  
    0  1e-007 3 0  
    2  3  
    0101000  
    +9 0 *  
    Sh  
     
    0101100  
    -30 0 +20 0 -16 0 +12 0 -10 0  +8 0 *  
    So  
     
    0100000  
    +7 0 *  
    CS  
     
    0101000  
    +6 3 *  
    Ve  
    1e-007  
    1 0 0  
    0 0  
     
    0101101  
    *  
    Ve  
    1e-007  
    2 0 0  
    0 0  
     
    0101101  
    *  
    Ed  
     1e-007 1 1 0  
    1  13 0 0 1  
    5  1 0  
    0  
     
    0101000  
    +4 0 -3 0 *  
    Co  
     
    1100000  
    +5 0 +2 0 *  
     
    +1 0   
    0 
```



